<?php
include('includes/header.php');
include('includes/session.php');
?>
<style>
  .content-wrapper {
    background-image: url('images/bg2.png');
    background-size: cover;
    /* or use 'contain' if you want to see the entire image */
    background-position: center;
    /* centers the image */
    background-repeat: no-repeat;
    /* prevents the image from repeating */
    /* makes the wrapper take the full height of the viewport */
  }

  .container {
    background: linear-gradient(to bottom right, #f8f9fa, #e3f2fd);
    /* Soft pastel gradient */
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
  }

  .main-footer {
    background: linear-gradient(to right, #f8f9fa, #e3f2fd);
    /* Soft gradient */
    color: #333;
    /* Dark text for readability */
    text-align: center;
    /* Centers text */
    padding: 15px 20px;
    /* Adds spacing */
    font-size: 14px;
    border-top: 2px solid #ddd;
    /* Subtle top border */
    box-shadow: 0px -2px 10px rgba(0, 0, 0, 0.1);
    /* Slight shadow at the top */
  }

  .main-footer a {
    color: #007bff;
    /* Blue link color */
    text-decoration: none;
    /* Removes underline */
    font-weight: bold;
  }

  .main-footer a:hover {
    text-decoration: underline;
    /* Adds underline on hover */
  }

  .pull-right {
    float: right;
  }

  @media (max-width: 768px) {
    .pull-right {
      float: none;
      display: block;
      text-align: center;
      margin-top: 10px;
    }
  }
</style>

<body class="hold-transition layout-top-nav sidebar-collapse">
  <div class="wrapper">
    <?php include('includes/navbar.php'); ?>

    <div class="content-wrapper">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col text-center">
            <h1 style="font-family:algerian; font-size: 150px;"><b>PAWPRINTS</b></h1>
          </div>
        </div>

        <div class="content">
          <div class="row">
            <div class="col-sm-9">
              <!-- Carousel -->
              <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                  <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                  <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                  <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                  <li data-target="#carouselExampleIndicators" data-slide-to="3"></li>
                </ol>
                <div class="carousel-inner">
                  <div class="carousel-item active">
                    <img class="d-block w-100" src="images/slider.jpg" alt="First slide">
                  </div>
                  <div class="carousel-item">
                    <img class="d-block w-100" src="images/slider2.jpg" alt="Second slide">
                  </div>
                  <div class="carousel-item">
                    <img class="d-block w-100" src="images/slider3.jpg" alt="Third slide">
                  </div>
                  <div class="carousel-item">
                    <img class="d-block w-100" src="images/slider4.jpg" alt="Fourth slide">
                  </div>
                </div>
                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                  <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                  <span class="carousel-control-next-icon" aria-hidden="true"></span>
                  <span class="sr-only">Next</span>
                </a>
              </div>
              <br>

              <!-- Products Section -->
              <h2>Products</h2>
              <?php
              $query = "SELECT * FROM products WHERE delete_flag = 0";
              $result = $conn->query($query);

              if ($result->num_rows > 0) {
                echo "<div class='row'>";
                while ($row = $result->fetch_assoc()) {
                  $image = !empty($row['photo']) ? 'images/' . $row['photo'] : 'images/noimage.jpg';
                  $price_display = !empty($row['discount_price']) ? number_format($row['discount_price'], 2) : number_format($row['price'], 2);
                  $has_discount = !empty($row['discount_price']);

                  echo "
                    <div class='col-sm-4'>
                      <div class='box box-solid'>
                        <div class='box-body prod-body'>
                          <a href='product.php?product=" . htmlspecialchars($row['slug']) . "'>
                            <div style='position: relative;'>
                              <img src='" . htmlspecialchars($image) . "' width='100%' height='230px' class='thumbnail'>
                              " . ($has_discount ? "<span class='badge badge-danger' style='position: absolute; top: 10px; left: 10px;'>Discount</span>" : "") . "
                            </div>
                            <h5>" . htmlspecialchars($row['name']) . "</h5>
                          </a>
                        </div>
                        <div class='box-footer'>
                          <b>Stocks: " . htmlspecialchars($row['stock']) . "</b><br>
                          <b>&#8369; " . $price_display . "</b>
                        </div>
                      </div>
                    </div>
                  ";
                }
                echo "</div>";
              } else {
                echo "No products found.";
              }
              ?>

              <div class="container mt-4">
                <h2 class="text-center mb-4">Services Available</h2>
                <div class="row">
                  <?php
                  $query = "SELECT * FROM services WHERE status = 1 AND delete_flag = 0";
                  $result = mysqli_query($conn, $query);

                  if (mysqli_num_rows($result) > 0) {
                    while ($row = mysqli_fetch_assoc($result)) {
                  ?>
                      <div class="col-md-4">
                        <div class="card">
                          <div class="card-header">
                            <?php echo $row["service_name"]; ?> (â‚±<?php echo $row["price"]; ?>)
                          </div>
                        </div>
                      </div>
                  <?php
                    }
                  } else {
                    echo "<div class='container'><p class='text-center'>No services found.</p></div>";
                  }
                  ?>
                </div>
              </div>
              <!-- /.col-sm-9 -->
            </div>
            <div class="col-sm-3">
              <?php include 'includes/sidebar.php'; ?>
            </div><!-- /.row -->
          </div><!-- /.content -->
        </div><!-- /.container -->
      </div><!-- /.content-wrapper -->

      <?php include('includes/footer.php'); ?>
      <?php include('includes/appointment_modal.php'); ?>
    </div><!-- ./wrapper -->

    <?php include('includes/scripts.php'); ?>
    <script>
      function getDetails() {
        $.ajax({
          type: 'POST',
          url: 'cart_details.php',
          dataType: 'html', // Changed to 'html'
          success: function(response) {
            $('#tbody').html(response);
          },
          error: function(xhr, status, error) {
            console.error("Error fetching cart details:", error);
          }
        });
      }
    </script>
</body>

</html>
